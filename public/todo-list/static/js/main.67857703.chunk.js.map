{"version":3,"sources":["../../core/persistant.ts","../../core/auth.ts","theme.ts","../../core/api-request.ts","components/Header.tsx","components/Item.tsx","components/NewItem.tsx","components/List.tsx","App.tsx","utils/use-book-api.ts","utils/use-promise-handler.tsx","index.tsx"],"names":["key","config","app","value","localStorage","getItem","data","JSON","parse","update","newData","setItem","stringify","persistant","Proxy","get","target","property","receiver","set","deleteProperty","logout","window","location","reload","theme","createMuiTheme","palette","primary","main","secondary","apiRequest","method","path","body","textResult","a","fetch","headers","undefined","response","status","ok","Error","statusText","text","json","Header","book","disabled","onRefresh","useTheme","AppBar","position","Toolbar","IconButton","color","onClick","Box","marginX","Typography","variant","noWrap","name","flexGrow","flexShrink","marginLeft","Button","endIcon","Cached","Item","item","index","onCheck","onEdit","onRemove","useState","editMode","setEditMode","editedTitle","setEditedTitle","apply","done","ClickAwayListener","onClickAway","event","Paper","elevation","padding","display","alignItems","marginRight","Checkbox","checked","TextField","fullWidth","label","placeholder","onChange","onKeyDown","keyCode","title","Check","Close","Edit","NewItem","onAdd","inputRef","useRef","setTitle","add","setTimeout","current","focus","square","style","backgroundColor","background","default","ArrowDropDown","innerRef","Add","clear","ClearAll","List","marginTop","Container","maxWidth","list","length","paddingTop","paddingBottom","marginBottom","map","id","added","useStyles","makeStyles","App","setBook","setStatus","readBook","addTodo","removeTodo","editTodoTitle","editTodoChecked","editTodoPosition","makeRequest","bookTimestamp","editTodo","useBookApi","error","setError","makePromise","makeErrorMessage","result","success","console","String","handlePromise","errorSnackbar","Snackbar","open","autoHideDuration","onClose","Alert","severity","usePromiseHandler","timestamp","refresh","append","useEffect","authCodeFromUrl","URLSearchParams","search","authCodeFromLocalStorage","history","replaceState","pathname","href","loginUrl","origin","authenticate","ReactDOM","render","ThemeProvider","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.67857703.chunk.js","sourcesContent":["const key = `app-data/${config.app}`\n\nconst value = localStorage.getItem(key)\nlet data: Persistant = value && JSON.parse(value)\ndata || update({})\n\nfunction update(newData: Persistant): void {\n  localStorage.setItem(key, JSON.stringify(newData))\n  data = newData\n}\n\nconst persistant: Persistant = new Proxy(data, {\n  get(target, property: keyof Persistant, receiver) {\n    return data[property]\n  },\n  set(target, property: keyof Persistant, value, receiver): boolean {\n    update({\n      ...data,\n      [property]: value\n    })\n    return true\n  },\n  deleteProperty(target, property: keyof Persistant): boolean {\n    const { [property]: value, ...newData } = data\n    update(newData)\n    return true\n  }\n}) as any\n\nexport default persistant\n","import persistant from './persistant'\n\n/**\n * Checks authentication status, resolves `auth-code` from URL,\n * returns true iff the app is authenticated and allowed to continue running.\n */\nexport function authenticate(): boolean {\n  const urlParams = new URLSearchParams(window.location.search)\n  const authCodeFromUrl = urlParams.get('auth-code')\n  const authCodeFromLocalStorage = persistant['auth-code']\n\n  if (authCodeFromUrl) {\n    persistant['auth-code'] = authCodeFromUrl\n    window.history.replaceState(null, '', window.location.pathname)\n  } else if (!authCodeFromLocalStorage) {\n    window.location.href = `${config.loginUrl}?app=${config.app}&url=${window.location.origin}${window.location.pathname}`\n    return false\n  }\n  return true\n}\n\n/**\n * Removes authentication and reloads the app,\n * pretty much redirecting it to the login page.\n */\nexport function logout(): void {\n  delete persistant['auth-code']\n  window.location.reload()\n}\n","import { createMuiTheme } from '@material-ui/core'\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#A049E7'\n    },\n    secondary: {\n      main: '#E96BED'\n    }\n  }\n})\n\nexport default theme\n","import persistant from './persistant'\nimport { logout } from './auth'\n\nexport async function apiRequest<R = void>(method: 'GET' | 'POST' | 'DELETE' | 'PUT', path: string, body?: any, textResult?: boolean): Promise<R> {\n  const response = await fetch(`/api/${path}`, {\n    method,\n    headers: {\n      'auth-code': persistant['auth-code']!,\n      'Content-Type': 'application/json'\n    },\n    body: body ? JSON.stringify(body) : undefined\n  })\n\n  if (response.status === 401) {\n    logout()\n    return null as any\n  }\n\n  if (!response.ok) throw new Error(`${response.statusText} (${response.status}): ${await response.text()}`)\n\n  return await (textResult ? response.text() : response.json())\n}\n","import React from 'react'\nimport { Theme, AppBar, Toolbar, Typography, Box, IconButton, Button } from '@material-ui/core'\nimport { useTheme } from '@material-ui/styles'\nimport { Cached as CachedIcon, ExitToApp as ExitIcon } from '@material-ui/icons'\n\nimport { logout } from '../../../core/auth'\n\ninterface Props {\n  book: Book | null\n  disabled?: boolean\n  onRefresh(): void\n}\n\nexport default function Header({ book, disabled, onRefresh }: Props) {\n  const theme = useTheme<Theme>()\n\n  return (\n    <AppBar position=\"absolute\">\n      <Toolbar>\n        <IconButton color=\"inherit\" disabled={disabled} onClick={() => logout()}>\n          <ExitIcon />\n        </IconButton>\n        <Box marginX={2}>\n          <Typography variant=\"h6\" noWrap>\n            Todo List\n          </Typography>\n        </Box>\n        {book && (\n          <Typography variant=\"subtitle2\" noWrap>\n            {book.name}\n          </Typography>\n        )}\n        <Box flexGrow={1} />\n        <Box flexGrow={0} flexShrink={0} marginLeft={2}>\n          <Button variant=\"outlined\" color=\"inherit\" endIcon={<CachedIcon />} disabled={disabled} onClick={onRefresh}>\n            Refresh&nbsp;&nbsp;\n          </Button>\n        </Box>\n      </Toolbar>\n    </AppBar>\n  )\n}\n","import React, { useState } from 'react'\nimport { Box, Paper, Typography, Checkbox, IconButton, ClickAwayListener, TextField } from '@material-ui/core'\nimport { Edit as EditIcon, Close as CloseIcon, Check as CheckIcon } from '@material-ui/icons'\n\ninterface Props {\n  item: Book['list'][number]\n  index: number\n  disabled?: boolean\n  onCheck?(checked: boolean): void\n  onEdit?(title: string): Promise<boolean>\n  onRemove?(): void\n}\n\nexport default function Item({ item, index, disabled, onCheck, onEdit, onRemove }: Props) {\n  const [editMode, setEditMode] = useState(false)\n  const [editedTitle, setEditedTitle] = useState('')\n\n  async function apply() {\n    const done = await onEdit?.(editedTitle)\n    setEditMode(!done)\n  }\n\n  if (editMode)\n    return (\n      <ClickAwayListener onClickAway={event => setEditMode(false)}>\n        <Paper elevation={6}>\n          <Box padding={2} display=\"flex\" alignItems=\"center\">\n            <Box marginRight={2}>\n              <Checkbox color=\"secondary\" checked={!!item.checked} disabled={true} />\n            </Box>\n            <TextField\n              fullWidth\n              disabled={disabled}\n              label=\"Todo Text\"\n              placeholder=\"Write the todo text here...\"\n              value={editedTitle}\n              onChange={({ target: { value } }) => setEditedTitle(value)}\n              onKeyDown={event => event.keyCode === 13 && apply()}\n            />\n            <Box flexGrow={1} />\n            <Box marginRight={1} marginLeft={2}>\n              <IconButton disabled={disabled} title=\"Apply\" onClick={() => apply()}>\n                <CheckIcon />\n              </IconButton>\n            </Box>\n            <IconButton disabled={disabled} title=\"Cancel\" onClick={() => setEditMode(false)}>\n              <CloseIcon />\n            </IconButton>\n          </Box>\n        </Paper>\n      </ClickAwayListener>\n    )\n\n  return (\n    <Paper elevation={2}>\n      <Box padding={2} display=\"flex\" alignItems=\"center\">\n        <Box marginRight={2}>\n          <Checkbox color=\"secondary\" checked={!!item.checked} disabled={disabled} onChange={(event, checked) => onCheck?.(checked)} />\n        </Box>\n        <Typography variant=\"subtitle1\">{item.title}</Typography>\n        <Box flexGrow={1} />\n        <Box marginRight={1} marginLeft={2}>\n          <IconButton\n            disabled={disabled}\n            title=\"Edit\"\n            onClick={() => {\n              setEditedTitle(item.title)\n              setEditMode(true)\n            }}\n          >\n            <EditIcon />\n          </IconButton>\n        </Box>\n        <IconButton disabled={disabled} title=\"Remove\" onClick={() => onRemove?.()}>\n          <CloseIcon />\n        </IconButton>\n      </Box>\n    </Paper>\n  )\n}\n","import React, { useState, useRef } from 'react'\nimport { Paper, Box, TextField, IconButton, Theme } from '@material-ui/core'\nimport { useTheme } from '@material-ui/styles'\nimport { ClearAll as ClearAllIcon, Add as AddIcon, ArrowDropDown as ArrowDropDownIcon } from '@material-ui/icons'\n\ninterface Props {\n  disabled?: boolean\n  onAdd?(title: string): Promise<boolean>\n}\n\nexport default function NewItem({ disabled, onAdd }: Props) {\n  const inputRef = useRef<HTMLInputElement>(null)\n  const [title, setTitle] = useState('')\n  const theme = useTheme<Theme>()\n\n  async function add() {\n    if (!onAdd) return\n\n    const added = await onAdd(title)\n    if (added) {\n      setTitle('')\n      setTimeout(() => inputRef.current?.focus?.()) //TODO: Not working.\n    }\n  }\n  function clear() {\n    setTitle('')\n    inputRef.current?.focus?.() //TODO: Not working.\n  }\n\n  return (\n    <Paper variant=\"outlined\" square>\n      <Box padding={2} display=\"flex\" alignItems=\"center\" style={{ backgroundColor: theme.palette.background.default }}>\n        <Box marginRight={2}>\n          <IconButton\n            disabled={disabled || true}\n            title=\"Select\"\n            onClick={() => {\n              //TODO: Implement suggestions.\n            }}\n          >\n            <ArrowDropDownIcon />\n          </IconButton>\n        </Box>\n        <TextField\n          innerRef={inputRef}\n          fullWidth\n          disabled={disabled}\n          label=\"New Todo\"\n          placeholder=\"Write the todo text here...\"\n          value={title}\n          onChange={({ target: { value } }) => setTitle(value)}\n          onKeyDown={event => event.keyCode === 13 && add()}\n        />\n        <Box flexGrow={1} />\n        <Box marginRight={1} marginLeft={2}>\n          <IconButton disabled={disabled || !title} title=\"Add\" onClick={() => add()}>\n            <AddIcon />\n          </IconButton>\n        </Box>\n        <IconButton disabled={disabled || !title} title=\"Clear\" onClick={() => clear()}>\n          <ClearAllIcon />\n        </IconButton>\n      </Box>\n    </Paper>\n  )\n}\n","import React from 'react'\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\nimport { Container, Typography, Box } from '@material-ui/core'\nimport Item from './Item'\nimport NewItem from './NewItem'\n\ninterface Props {\n  book: Book | null\n  disabled?: boolean\n  onAdd?(title: string, append: boolean): Promise<boolean>\n  onCheck?(id: number, checked: boolean): void\n  onEdit?(id: number, title: string): Promise<boolean>\n  onRemove?(id: number): void\n}\n\nexport default function List({ book, disabled, onAdd, onCheck, onEdit, onRemove }: Props) {\n  if (!book) return null\n\n  return (\n    <Box marginTop={10}>\n      <Container maxWidth=\"md\">\n        {book.list.length === 0 ? (\n          <Box paddingTop={2} paddingBottom={4}>\n            <Typography variant=\"body1\">There is no items in the list!</Typography>\n            <Typography variant=\"subtitle1\" color=\"secondary\">\n              Start by adding a <strong>new</strong> todo.\n            </Typography>\n          </Box>\n        ) : (\n          <>\n            <Box marginBottom={2}>\n              <NewItem disabled={disabled} onAdd={onAdd && (async title => onAdd(title, false))} />\n            </Box>\n            {book.list.map((item, index) => (\n              <Box marginBottom={2} key={item.id}>\n                <Item\n                  item={item}\n                  index={index}\n                  disabled={disabled}\n                  onCheck={onCheck && (checked => onCheck(item.id, checked))}\n                  onEdit={onEdit && (async title => onEdit(item.id, title))}\n                  onRemove={onRemove && (() => onRemove(item.id))}\n                />\n              </Box>\n            ))}\n          </>\n        )}\n        <NewItem\n          disabled={disabled}\n          onAdd={\n            onAdd &&\n            (async title => {\n              const added = await onAdd(title, true)\n              //TODO: Scroll to the end after render completed.\n              return added\n            })\n          }\n        />\n      </Container>\n    </Box>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { Theme, Typography, Box, Button } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/styles'\n\nimport useBookApi from './utils/use-book-api'\n\nimport Header from './components/Header'\nimport usePromiseHandler from './utils/use-promise-handler'\nimport List from './components/List'\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  //...\n}))\n\nfunction App() {\n  const [book, setBook] = useState<Book | null>(null)\n  const { status, readBook, addTodo, removeTodo, editTodoTitle, editTodoChecked, editTodoPosition } = useBookApi()\n  const { handlePromise, errorSnackbar } = usePromiseHandler()\n\n  const disabled = !!status\n  const bookTimestamp = book ? book.timestamp : 0\n\n  async function refresh() {\n    const response = await handlePromise(readBook)\n    response.success && setBook(response.result)\n  }\n  async function add(title: string, append: boolean): Promise<boolean> {\n    const position = append ? undefined : 0\n    const response = await handlePromise(() => addTodo(bookTimestamp, title, position))\n    response.success && setBook(response.result)\n    return response.success\n  }\n  async function check(id: number, checked: boolean) {\n    const response = await handlePromise(() => editTodoChecked(bookTimestamp, id, checked))\n    response.success && setBook(response.result)\n  }\n  async function edit(id: number, title: string): Promise<boolean> {\n    const response = await handlePromise(() => editTodoTitle(bookTimestamp, id, title))\n    response.success && setBook(response.result)\n    return response.success\n  }\n  async function remove(id: number) {\n    const response = await handlePromise(() => removeTodo(bookTimestamp, id))\n    response.success && setBook(response.result)\n  }\n\n  useEffect(() => {\n    refresh()\n  }, [])\n\n  const classes = useStyles()\n\n  return (\n    <>\n      <Header book={book} disabled={disabled} onRefresh={refresh} />\n      <List book={book} disabled={disabled} onAdd={add} onCheck={check} onEdit={edit} onRemove={remove} />\n      {errorSnackbar}\n    </>\n  )\n}\n\nexport default App\n","import { useState } from 'react'\n\nimport { apiRequest } from '../../../core/api-request'\n\ntype Status = 'reading book' | 'adding todo' | 'removing todo' | 'editing todo'\n\nexport default function useBookApi() {\n  const [status, setStatus] = useState<Status | null>(null)\n\n  return {\n    status,\n    readBook,\n    addTodo,\n    removeTodo,\n    editTodoTitle,\n    editTodoChecked,\n    editTodoPosition\n  }\n\n  async function readBook(): Promise<Book> {\n    return await makeRequest('reading book', apiRequest('GET', `todo-list/book`))\n  }\n  async function addTodo(bookTimestamp: number, title: string, position?: number): Promise<Book> {\n    return await makeRequest('adding todo', apiRequest('POST', `todo-list/book/todo`, { bookTimestamp, title, position }))\n  }\n  async function removeTodo(bookTimestamp: number, id: number): Promise<Book> {\n    return await makeRequest('removing todo', apiRequest('DELETE', `todo-list/book/todo`, { bookTimestamp, id }))\n  }\n  async function editTodo(\n    bookTimestamp: number,\n    id: number,\n    title: string | undefined,\n    checked: boolean | undefined,\n    position: number | undefined\n  ): Promise<Book> {\n    return await makeRequest('editing todo', apiRequest('PUT', `todo-list/book/todo`, { bookTimestamp, id, title, checked, position }))\n  }\n\n  async function editTodoTitle(bookTimestamp: number, id: number, title: string) {\n    return await editTodo(bookTimestamp, id, title, undefined, undefined)\n  }\n  async function editTodoChecked(bookTimestamp: number, id: number, checked: boolean) {\n    return await editTodo(bookTimestamp, id, undefined, checked, undefined)\n  }\n  async function editTodoPosition(bookTimestamp: number, id: number, position: number) {\n    return await editTodo(bookTimestamp, id, undefined, undefined, position)\n  }\n\n  async function makeRequest(status: Status, response: Promise<Book>): Promise<Book> {\n    if (!status) throw new Error(`Not possible while ${status}.`)\n\n    setStatus(status)\n    try {\n      const book: Book = await response\n      setStatus(null)\n      return book\n    } catch (reason) {\n      setStatus(null)\n      throw reason\n    }\n  }\n}\n","import React, { useState } from 'react'\nimport { Snackbar } from '@material-ui/core'\nimport { Alert } from '@material-ui/lab'\n\nexport default function usePromiseHandler() {\n  const [error, setError] = useState<string | null>(null)\n\n  async function handlePromise<T>(\n    makePromise: () => Promise<T>,\n    makeErrorMessage?: (reason: any) => string\n  ): Promise<{ success: true; result: T } | { success: false }> {\n    try {\n      const result = await makePromise()\n      setError(null)\n      return { success: true, result }\n    } catch (reason) {\n      console.error(reason)\n      setError(makeErrorMessage ? makeErrorMessage(reason) : String(reason))\n      return { success: false }\n    }\n  }\n\n  const errorSnackbar = (\n    <Snackbar open={!!error} autoHideDuration={5000} onClose={() => setError(null)}>\n      <Alert severity=\"error\" onClose={() => setError(null)}>\n        {error}\n      </Alert>\n    </Snackbar>\n  )\n\n  return {\n    handlePromise,\n    errorSnackbar\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { CssBaseline, ThemeProvider } from '@material-ui/core'\n\nimport { authenticate } from '../../core/auth'\nimport theme from './theme'\nimport App from './App'\n// import * as serviceWorker from './serviceWorker';\n\nauthenticate() &&\n  ReactDOM.render(\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <App />\n    </ThemeProvider>,\n    document.getElementById('root')\n  )\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}